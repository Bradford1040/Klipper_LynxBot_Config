[gcode_macro PID_PROFILE]
rename_existing: PID_PROFILE_BASE
gcode:
  {% set EXECUTE_COMMAND = True %}
  {% if params.HEATER is defined and params.LOAD is defined %}
    {% if params.HEATER == 'extruder' and printer.extruder.pid_profile == params.LOAD %}
      {% set EXECUTE_COMMAND = False %}
    {% elif params.HEATER == 'heater_bed' and printer.heater_bed.pid_profile == params.LOAD %}
      {% set EXECUTE_COMMAND = False %}
    {% endif %}
  {% endif %}

  {% if EXECUTE_COMMAND %}
    PID_PROFILE_BASE {rawparams}
  {% endif %}
